import { ContractFactory, JsonRpcProvider, Wallet } from 'ethers';
const contractABI = [
    'event OwnershipTransferred(address indexed previousOwner, address indexed newOwner)',
    'event Trade(address indexed trader, address indexed subject, bool isBuy, uint256 shareAmount, uint256 ethAmount, uint256 protocolEthAmount, uint256 subjectEthAmount, uint256 supply)',
    'function buyShares(address sharesSubject, uint256 amount) payable',
    'function getBuyPrice(address sharesSubject, uint256 amount) external view returns (uint256)',
    'function getBuyPriceAfterFee(address sharesSubject, uint256 amount) external view returns (uint256)',
    'function getPrice(uint256 supply, uint256 amount) external pure returns (uint256)',
    'function getSellPrice(address sharesSubject, uint256 amount) external view returns (uint256)',
    'function getSellPriceAfterFee(address sharesSubject, uint256 amount) external view returns (uint256)',
    'function owner() external view returns (address)',
    'function protocolFeeDestination() external view returns (address)',
    'function protocolFeePercent() external view returns (uint256)',
    'function renounceOwnership() external',
    'function sellShares(address sharesSubject, uint256 amount) payable',
    'function setFeeDestination(address _feeDestination) external',
    'function setProtocolFeePercent(uint256 _feePercent) external',
    'function setSubjectFeePercent(uint256 _feePercent) external',
    'function sharesBalance(address, address) external view returns (uint256)',
    'function sharesSupply(address) external view returns (uint256)',
    'function subjectFeePercent() external view returns (uint256)',
    'function transferOwnership(address newOwner) external'
  ];  

const provider = new JsonRpcProvider("http://127.0.0.1:8545")
const contractByteCode = "0x6080604052600436106101095760003560e01c8063715018a611610095578063b51d053411610064578063b51d053414610382578063d6e6eb9f1461039e578063f2fde38b146103c9578063f9931be0146103f2578063fbe532341461042f57610109565b8063715018a6146102da5780638da5cb5b146102f15780639ae717811461031c578063a49834211461035957610109565b80634635256e116100dc5780634635256e146101f05780634ce7957c1461022d5780635a8a764e146102585780635cf4ee91146102815780636945b123146102be57610109565b8063020235ff1461010e5780630f026f6d1461014b5780632267a89c1461018857806324dc441d146101c5575b600080fd5b34801561011a57600080fd5b506101356004803603810190610130919061140d565b610458565b6040516101429190611466565b60405180910390f35b34801561015757600080fd5b50610172600480360381019061016d91906114ad565b61047d565b60405161017f9190611466565b60405180910390f35b34801561019457600080fd5b506101af60048036038101906101aa91906114ad565b6104f8565b6040516101bc9190611466565b60405180910390f35b3480156101d157600080fd5b506101da610573565b6040516101e79190611466565b60405180910390f35b3480156101fc57600080fd5b50610217600480360381019061021291906114ad565b610579565b6040516102249190611466565b60405180910390f35b34801561023957600080fd5b506102426105cc565b60405161024f91906114fc565b60405180910390f35b34801561026457600080fd5b5061027f600480360381019061027a9190611517565b6105f2565b005b34801561028d57600080fd5b506102a860048036038101906102a39190611544565b610604565b6040516102b59190611466565b60405180910390f35b6102d860048036038101906102d391906114ad565b61073a565b005b3480156102e657600080fd5b506102ef610b9d565b005b3480156102fd57600080fd5b50610306610bb1565b60405161031391906114fc565b60405180910390f35b34801561032857600080fd5b50610343600480360381019061033e91906114ad565b610bda565b6040516103509190611466565b60405180910390f35b34801561036557600080fd5b50610380600480360381019061037b9190611517565b610c38565b005b61039c600480360381019061039791906114ad565b610c4a565b005b3480156103aa57600080fd5b506103b3611173565b6040516103c09190611466565b60405180910390f35b3480156103d557600080fd5b506103f060048036038101906103eb9190611584565b611179565b005b3480156103fe57600080fd5b5061041960048036038101906104149190611584565b6111fc565b6040516104269190611466565b60405180910390f35b34801561043b57600080fd5b5061045660048036038101906104519190611584565b611214565b005b6004602052816000526040600020602052806000526040600020600091509150505481565b60008061048a8484610579565b90506000670de0b6b3a7640000600254836104a591906115e0565b6104af9190611651565b90506000670de0b6b3a7640000600354846104ca91906115e0565b6104d49190611651565b90508082846104e39190611682565b6104ed9190611682565b935050505092915050565b6000806105058484610bda565b90506000670de0b6b3a76400006002548361052091906115e0565b61052a9190611651565b90506000670de0b6b3a76400006003548461054591906115e0565b61054f9190611651565b905080828461055e91906116b6565b61056891906116b6565b935050505092915050565b60035481565b60006105c4600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205483610604565b905092915050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6105fa611260565b8060038190555050565b600080600084146106665760066001808661061f91906116b6565b600261062b91906115e0565b6106359190611682565b8560018761064391906116b6565b61064d91906115e0565b61065791906115e0565b6106619190611651565b610669565b60005b90506000808514801561067c5750600184145b6106f957600660018560018861069291906116b6565b61069c9190611682565b60026106a891906115e0565b6106b29190611682565b85876106be9190611682565b866001896106cc91906116b6565b6106d69190611682565b6106e091906115e0565b6106ea91906115e0565b6106f49190611651565b6106fc565b60005b90506000828261070c91906116b6565b9050613e80670de0b6b3a76400008261072591906115e0565b61072f9190611651565b935050505092915050565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905060008111806107b857503373ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16145b6107f7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107ee9061176d565b60405180910390fd5b60006108038284610604565b90506000670de0b6b3a76400006002548361081e91906115e0565b6108289190611651565b90506000670de0b6b3a76400006003548461084391906115e0565b61084d9190611651565b905080828461085c9190611682565b6108669190611682565b3410156108a8576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161089f906117d9565b60405180910390fd5b84600460008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546109309190611682565b600460008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555084846109bc9190611682565b600560008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055507f2c76e7a47fd53e2854856ac3f0a5f3ee40d15cfaa82266357ea9779c486ab9c333876001888787878c8c610a349190611682565b604051610a48989796959493929190611814565b60405180910390a16000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1683604051610a98906118c3565b60006040518083038185875af1925050503d8060008114610ad5576040519150601f19603f3d011682016040523d82523d6000602084013e610ada565b606091505b5050905060008773ffffffffffffffffffffffffffffffffffffffff1683604051610b04906118c3565b60006040518083038185875af1925050503d8060008114610b41576040519150601f19603f3d011682016040523d82523d6000602084013e610b46565b606091505b50509050818015610b545750805b610b93576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b8a90611924565b60405180910390fd5b5050505050505050565b610ba5611260565b610baf60006112de565b565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000610c3082600560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054610c2a91906116b6565b83610604565b905092915050565b610c40611260565b8060028190555050565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050818111610cd0576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610cc790611990565b60405180910390fd5b6000610ce78383610ce191906116b6565b84610604565b90506000670de0b6b3a764000060025483610d0291906115e0565b610d0c9190611651565b90506000670de0b6b3a764000060035484610d2791906115e0565b610d319190611651565b905084600460008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541015610df2576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610de9906119fc565b60405180910390fd5b84600460008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054610e7a91906116b6565b600460008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508484610f0691906116b6565b600560008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055507f2c76e7a47fd53e2854856ac3f0a5f3ee40d15cfaa82266357ea9779c486ab9c333876000888787878c8c610f7e91906116b6565b604051610f92989796959493929190611814565b60405180910390a160003373ffffffffffffffffffffffffffffffffffffffff16828486610fc091906116b6565b610fca91906116b6565b604051610fd6906118c3565b60006040518083038185875af1925050503d8060008114611013576040519150601f19603f3d011682016040523d82523d6000602084013e611018565b606091505b505090506000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1684604051611064906118c3565b60006040518083038185875af1925050503d80600081146110a1576040519150601f19603f3d011682016040523d82523d6000602084013e6110a6565b606091505b5050905060008873ffffffffffffffffffffffffffffffffffffffff16846040516110d0906118c3565b60006040518083038185875af1925050503d806000811461110d576040519150601f19603f3d011682016040523d82523d6000602084013e611112565b606091505b505090508280156111205750815b80156111295750805b611168576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161115f90611924565b60405180910390fd5b505050505050505050565b60025481565b611181611260565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036111f0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016111e790611a8e565b60405180910390fd5b6111f9816112de565b50565b60056020528060005260406000206000915090505481565b61121c611260565b80600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b6112686113a2565b73ffffffffffffffffffffffffffffffffffffffff16611286610bb1565b73ffffffffffffffffffffffffffffffffffffffff16146112dc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016112d390611afa565b60405180910390fd5b565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050816000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b600033905090565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006113da826113af565b9050919050565b6113ea816113cf565b81146113f557600080fd5b50565b600081359050611407816113e1565b92915050565b60008060408385031215611424576114236113aa565b5b6000611432858286016113f8565b9250506020611443858286016113f8565b9150509250929050565b6000819050919050565b6114608161144d565b82525050565b600060208201905061147b6000830184611457565b92915050565b61148a8161144d565b811461149557600080fd5b50565b6000813590506114a781611481565b92915050565b600080604083850312156114c4576114c36113aa565b5b60006114d2858286016113f8565b92505060206114e385828601611498565b9150509250929050565b6114f6816113cf565b82525050565b600060208201905061151160008301846114ed565b92915050565b60006020828403121561152d5761152c6113aa565b5b600061153b84828501611498565b91505092915050565b6000806040838503121561155b5761155a6113aa565b5b600061156985828601611498565b925050602061157a85828601611498565b9150509250929050565b60006020828403121561159a576115996113aa565b5b60006115a8848285016113f8565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006115eb8261144d565b91506115f68361144d565b92508282026116048161144d565b9150828204841483151761161b5761161a6115b1565b5b5092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b600061165c8261144d565b91506116678361144d565b92508261167757611676611622565b5b828204905092915050565b600061168d8261144d565b91506116988361144d565b92508282019050808211156116b0576116af6115b1565b5b92915050565b60006116c18261144d565b91506116cc8361144d565b92508282039050818111156116e4576116e36115b1565b5b92915050565b600082825260208201905092915050565b7f4f6e6c79207468652073686172657327207375626a6563742063616e2062757960008201527f2074686520666972737420736861726500000000000000000000000000000000602082015250565b60006117576030836116ea565b9150611762826116fb565b604082019050919050565b600060208201905081810360008301526117868161174a565b9050919050565b7f496e73756666696369656e74207061796d656e74000000000000000000000000600082015250565b60006117c36014836116ea565b91506117ce8261178d565b602082019050919050565b600060208201905081810360008301526117f2816117b6565b9050919050565b60008115159050919050565b61180e816117f9565b82525050565b60006101008201905061182a600083018b6114ed565b611837602083018a6114ed565b6118446040830189611805565b6118516060830188611457565b61185e6080830187611457565b61186b60a0830186611457565b61187860c0830185611457565b61188560e0830184611457565b9998505050505050505050565b600081905092915050565b50565b60006118ad600083611892565b91506118b88261189d565b600082019050919050565b60006118ce826118a0565b9150819050919050565b7f556e61626c6520746f2073656e642066756e6473000000000000000000000000600082015250565b600061190e6014836116ea565b9150611919826118d8565b602082019050919050565b6000602082019050818103600083015261193d81611901565b9050919050565b7f43616e6e6f742073656c6c20746865206c617374207368617265000000000000600082015250565b600061197a601a836116ea565b915061198582611944565b602082019050919050565b600060208201905081810360008301526119a98161196d565b9050919050565b7f496e73756666696369656e742073686172657300000000000000000000000000600082015250565b60006119e66013836116ea565b91506119f1826119b0565b602082019050919050565b60006020820190508181036000830152611a15816119d9565b9050919050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b6000611a786026836116ea565b9150611a8382611a1c565b604082019050919050565b60006020820190508181036000830152611aa781611a6b565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572600082015250565b6000611ae46020836116ea565b9150611aef82611aae565b602082019050919050565b60006020820190508181036000830152611b1381611ad7565b905091905056fea2646970667358221220cebed752f67094eaf80084d89578d96bc6f4fdbc3356576a982a1a23262a11e864736f6c63430008120033"
const PRIVATE_KEY = "0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80"
const wallet = new Wallet(PRIVATE_KEY, provider); // private key with coins

const factory = new ContractFactory(contractABI, contractByteCode, wallet);

// If your contract requires constructor args, you can specify them here
const contract = await factory.deploy({ gasLimit: 1 * 10 ** 6 });

console.log(contract);
